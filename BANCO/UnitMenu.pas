unit UnitMenu;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, Menus, ExtCtrls, ComCtrls, jpeg, StdCtrls, Buttons, Mask,
  ToolEdit, Grids, DBGrids, sSkinManager, sSkinProvider, sHintManager,
  sBitBtn, sPanel, sListView, acShellCtrls, sMonthCalendar, RxGIF, sEdit,
  sSpinEdit, HTTPApp, OleCtrls, SHDocVw;

type
  TForm_menu = class(TForm)
    StatusBar1: TStatusBar;
    Timer1: TTimer;
    Image1: TImage;
    DateEdit1: TDateEdit;
    MainMenu1: TMainMenu;
    CADASTRO1: TMenuItem;
    MOVIMENTO1: TMenuItem;
    RELATRIO1: TMenuItem;
    UTILITRIO1: TMenuItem;
    AJUDA1: TMenuItem;
    SAIR1: TMenuItem;
    Cidade2: TMenuItem;
    Cliente1: TMenuItem;
    Estado1: TMenuItem;
    N1: TMenuItem;
    Fornecedor1: TMenuItem;
    Marca1: TMenuItem;
    Produto1: TMenuItem;
    Usario1: TMenuItem;
    CAixa1: TMenuItem;
    ContasaPagar1: TMenuItem;
    ContasaReceber1: TMenuItem;
    N2: TMenuItem;
    RealizarCompra1: TMenuItem;
    RealizarVenda1: TMenuItem;
    Cidade1: TMenuItem;
    Cliente2: TMenuItem;
    ContasaPagar2: TMenuItem;
    ContasaPagar: TMenuItem;
    ContasaReceber3: TMenuItem;
    Fornecedor2: TMenuItem;
    Produto2: TMenuItem;
    Venda1: TMenuItem;
    BackupREstaurao1: TMenuItem;
    Calculadora1: TMenuItem;
    Calendrio1: TMenuItem;
    DoSistema1: TMenuItem;
    SobreoSistema1: TMenuItem;
    SairdoSistema1: TMenuItem;
    rocarUsario1: TMenuItem;
    Descarte1: TMenuItem;
    Button1: TBitBtn;
    BitBtn8: TBitBtn;
    BitBtn7: TBitBtn;
    BitBtn6: TBitBtn;
    BT_VENDA: TBitBtn;
    BT_COMP: TBitBtn;
    BT_PRO: TBitBtn;
    BT_FOR: TBitBtn;
    btn_cliente: TBitBtn;
    Caixa2: TMenuItem;
    Restaurar1: TMenuItem;
    Realizar1: TMenuItem;
    Image2: TImage;
   // procedure Cidade1Click(Sender: TObject);
    procedure FornecedorClick(Sender: TObject);
    procedure RealizarCompra1Click(Sender: TObject);
    procedure Timer1Timer(Sender: TObject);
    procedure SAIR2Click(Sender: TObject);
    procedure ContasaPagar1Click(Sender: TObject);
    procedure Calendrio1Click(Sender: TObject);
    procedure Usurio1Click(Sender: TObject);
    procedure RealizarVenda1Click(Sender: TObject);
    procedure ContasaReceber1Click(Sender: TObject);
    procedure Sair3Click(Sender: TObject);
//    procedure Trocar_UsuarioClick(Sender: TObject);
    procedure Cliente2Click(Sender: TObject);
    //procedure ContasaPagar2Click(Sender: TObject);
//    procedure Sobre1Click(Sender: TObject);
    procedure Fornecedor1Click(Sender: TObject);
    procedure btn_clienteClick(Sender: TObject);
    procedure BT_FORClick(Sender: TObject);
    procedure BT_PROClick(Sender: TObject);
    procedure BT_COMPClick(Sender: TObject);
    procedure BT_VENDAClick(Sender: TObject);
    procedure BitBtn6Click(Sender: TObject);
    procedure BitBtn7Click(Sender: TObject);
    procedure BitBtn8Click(Sender: TObject);
   // procedure BackupRestore1Click(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure Fornecedor2Click(Sender: TObject);
   // procedure Usuario1Click(Sender: TObject);
    //procedure Produtos1Click(Sender: TObject);
    procedure Cliente1Click(Sender: TObject);
    procedure Caixa1Click(Sender: TObject);
    //procedure Produtos2Click(Sender: TObject);
    procedure Cidade2Click(Sender: TObject);
    procedure Marca1Click(Sender: TObject);
    procedure Estado1Click(Sender: TObject);
    procedure Produto1Click(Sender: TObject);
    procedure Usario1Click(Sender: TObject);
    procedure ContasaPagarClick(Sender: TObject);
    procedure Produto2Click(Sender: TObject);
    procedure rocarUsario1Click(Sender: TObject);
    procedure SobreoSistema1Click(Sender: TObject);
    procedure SairdoSistema1Click(Sender: TObject);
    procedure CAixa2Click(Sender: TObject);
    procedure Cidade1Click(Sender: TObject);
    procedure Descarte1Click(Sender: TObject);
    procedure ContasaReceber3Click(Sender: TObject);
    procedure Button10Click(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Calculadora1Click(Sender: TObject);
    procedure Restaurar1Click(Sender: TObject);
    procedure Realizar1Click(Sender: TObject);
    procedure BitBtn1Click(Sender: TObject);
    procedure ContasaPagar2Click(Sender: TObject);
    procedure Venda1Click(Sender: TObject);
    procedure DoSistema1Click(Sender: TObject);
   
  private
    { Private declarations }
  public
    { Public declarations }
    bck:integer;
  end;

var
  Form_menu: TForm_menu;


implementation

uses Unit_Dm, Unit_Cliente, Unit_Cidade, Unit_Estado, Unit_Fornecedor,
  Unit_Marca, Unit_Produto, Unit_Funcionario, Unit_Caixa, Unit_Compra,
  Unit_Venda, Unit_Conta_Pagar, Unit_Conta_Receber, Unit_Login,
  Unit_Backup, Unit_Calendario, Unit_Sobre, Unit_Descarte,
  Unit_Relatorio_Cliente, Unit_Relatorio_Cidade, Unit_Relatorio_Produto,
  Unit_Relatorio_Fornecedor, Unit_Tela_Contas_Pagar,
  Unit_Tela_Contas_Receber, Unit_Alerta, Unit_Rel_tela_fonecedor,
  Unit_Rel_tela_Cliente, Unit_Relatorio_Caixa_Completo,
  Unit_Rel_Tela_Caixa, Unit_Rel_Tele_Compra, Unit_Rel_Tela_Venda,
  Unit_Ajuda_Sistema;

{$R *.dfm}


procedure TForm_menu.FornecedorClick(Sender: TObject);
begin
//Application.CreateForm(TForm_Cliente,Form_Cliente);
//Form_Cliente.ShowModal;
//Form_Cliente.Free;

end;

function SetScreenResolution(Width, Height: integer): Longint;
var
DeviceMode: TDeviceMode;
begin
with DeviceMode do begin
dmSize := SizeOf(TDeviceMode);
dmPelsWidth := Width;
dmPelsHeight := Height;
dmFields := DM_PELSWIDTH or DM_PELSHEIGHT;
end;
Result := ChangeDisplaySettings(DeviceMode, CDS_UPDATEREGISTRY);
end;

procedure TForm_menu.RealizarCompra1Click(Sender: TObject);
begin
Application.CreateForm(TForm_Mov_Compra,Form_Mov_Compra);
Form_Mov_Compra.ShowModal;
Form_Mov_Compra.Free;

end;

procedure TForm_menu.Timer1Timer(Sender: TObject);
begin
  StatusBar1.Panels[0].Text := ' ' + FormatDateTime('hh:nn:ss',now); //
StatusBar1.Panels[1].Text := ' ' + FormatDateTime ('dddd", "dd" de "mmmm" de "yyyy',now); //

end;

procedure TForm_menu.SAIR2Click(Sender: TObject);
begin
if Application.MessageBox('Deseja Sair do Sistema ?','SOF CONTROL', MB_yesno + MB_Iconquestion) = Id_YES then begin
  Close;


end;
end;

procedure TForm_menu.ContasaPagar1Click(Sender: TObject);
begin
Application.CreateForm(TMov_Conta_Pagar,Mov_Conta_Pagar);
Mov_Conta_Pagar.ShowModal;
Mov_Conta_Pagar.Free;

end;

procedure TForm_menu.Calendrio1Click(Sender: TObject);
begin
Application.CreateForm(TForm_Calendario,Form_Calendario);
Form_Calendario.ShowModal;
Form_Calendario.Free;

end;

procedure TForm_menu.Usurio1Click(Sender: TObject);
begin
//Application.CreateForm(TForm_Produto,Form_Produto);
//Form_Produto.ShowModal;
//Form_Produto.Free;
//DM.Q_consulta_Marca.Open;
end;

procedure TForm_menu.RealizarVenda1Click(Sender: TObject);
begin
Application.CreateForm(TForm_Mov_Venda,Form_Mov_Venda);
Form_Mov_Venda.ShowModal;
Form_Mov_Venda.Free;

end;

procedure TForm_menu.ContasaReceber1Click(Sender: TObject);
begin
Application.CreateForm(TMov_Conta_Receber,Mov_Conta_Receber);
Mov_Conta_Receber.ShowModal;
Mov_Conta_Receber.Free;

end;

procedure TForm_menu.Sair3Click(Sender: TObject);
begin
if Application.MessageBox('Deseja Sair do Sistema ? ','SOF CONTROL', MB_yesno + MB_Iconquestion) = Id_YES then begin
  Close;


end;
end;



procedure TForm_menu.Cliente2Click(Sender: TObject);
begin
Application.CreateForm(TRel_Tela_Cliente,Rel_Tela_Cliente);
Rel_Tela_Cliente.ShowModal;
Rel_Tela_Cliente.Free;

end;





procedure TForm_menu.Fornecedor1Click(Sender: TObject);
begin
Application.CreateForm(TForm_Fornecedor, Form_Fornecedor);
Form_Fornecedor.ShowModal;
Form_Fornecedor.Free;
end;


procedure TForm_menu.btn_clienteClick(Sender: TObject);
begin
Application.CreateForm(TForm_Cliente,Form_Cliente);
Form_Cliente.ShowModal;
Form_Cliente.Free;
end;

procedure TForm_menu.BT_FORClick(Sender: TObject);
begin
Application.CreateForm(TForm_Fornecedor, Form_Fornecedor);
Form_Fornecedor.ShowModal;
Form_Fornecedor.Free;
end;

procedure TForm_menu.BT_PROClick(Sender: TObject);
begin
Application.CreateForm(TForm_Produto,Form_Produto);
Form_Produto.ShowModal;
DM.Q_Grupo.Open;
end;

procedure TForm_menu.BT_COMPClick(Sender: TObject);
begin
Application.CreateForm(TForm_Mov_Compra,Form_Mov_Compra);
Form_Mov_Compra.ShowModal;
Form_Mov_Compra.Free;
end;

procedure TForm_menu.BT_VENDAClick(Sender: TObject);
begin
Application.CreateForm(TForm_Mov_Venda,Form_Mov_Venda);
Form_Mov_Venda.ShowModal;
Form_Mov_Venda.Free;
end;

procedure TForm_menu.BitBtn6Click(Sender: TObject);
begin
Application.CreateForm(TMov_Conta_Pagar,Mov_Conta_Pagar);
Mov_Conta_Pagar.ShowModal;
Mov_Conta_Pagar.Free;
end;

procedure TForm_menu.BitBtn7Click(Sender: TObject);
begin
Application.CreateForm(TMov_Conta_Receber,Mov_Conta_Receber);
Mov_Conta_Receber.ShowModal;
Mov_Conta_Receber.Free;
end;

procedure TForm_menu.BitBtn8Click(Sender: TObject);
begin
if Application.MessageBox('Deseja Sair do Sistema ?','SOF CONTROL', MB_yesno + MB_Iconquestion) = Id_YES then begin
  Close;

end;
end;


procedure TForm_menu.FormCreate(Sender: TObject);
var o : integer;
var Mens: String;
  I: Integer;
  fAlertaMsn: TForm;
  BarraIniciar: HWND; {Barra Iniciar}
  tmAltura: Integer;
  tmRect: TRect;
  xTop : Integer;
  xIniTop : Integer;
begin

DateEdit1.Date := (Now);
DateEdit1.Visible := False;
o := 0;
if DateEdit1.Date = (date)then begin
  dm.Q_Caixa.First;
  while NOT dm.Q_caixa.Eof do begin
    if dm.Q_CaixaDT_INICIAL.Value = (date) then begin
      o := 1;
      Button1.Visible := FALSE;
    end;

    dm.Q_caixa.Next;
end;
end;
 if o = 0 then begin
  { //localiza o Handle da janela iniciar
  BarraIniciar := FindWindow('Shell_TrayWnd', nil);
  //Pega o "retângulo" que envolve a barra e sua altura
  GetWindowRect(BarraIniciar, tmRect);
  tmAltura := tmRect.Bottom - tmRect.Top;
  fAlertaMsn := TFormAlerta.Create(Self);
  with fAlertaMsn do
  begin
    Left := Screen.Width - ClientWidth;
    if tmRect.Top = -2 then
      tmAltura := 30;
    //Pega o top final
    xTop := Screen.Height - ClientHeight - tmAltura;
    //Pega o top inicial
    xIniTop := Screen.Height + ClientHeight + tmAltura;
    Top := xIniTop;
    for I := xIniTop downto xTop do
    begin
      Top := Top - 1;
      Show;
      Update;
      Application.ProcessMessages;
      Sleep(1);
    end;
    Sleep(10000);
    Close;
    FreeAndNil(fAlertaMsn);

end;*}
Button1.Visible := tRUE;
end;
end;

procedure TForm_menu.FormClose(Sender: TObject; var Action: TCloseAction);
begin
Application.Terminate;
end;

procedure TForm_menu.Fornecedor2Click(Sender: TObject);
begin
Application.CreateForm(TRel_Tela_Fornecedores,Rel_Tela_Fornecedores);
Rel_Tela_Fornecedores.ShowModal;
Rel_Tela_Fornecedores.Free;
end;


procedure TForm_menu.Cliente1Click(Sender: TObject);
begin
Application.CreateForm(TForm_Cliente,Form_Cliente);
Form_Cliente.ShowModal;
Form_Cliente.Free;
end;

procedure TForm_menu.Caixa1Click(Sender: TObject);
begin

Application.CreateForm(TForm_Caixa,Form_Caixa);
Form_Caixa.ShowModal;
Form_Caixa.Free;

end;



procedure TForm_menu.Cidade2Click(Sender: TObject);
begin
Application.CreateForm(TForm_Cidade, Form_Cidade);
Form_Cidade.ShowModal;
Form_Cidade.Free;
end;

procedure TForm_menu.Marca1Click(Sender: TObject);
begin
Application.CreateForm(TForm_Usuario,Form_Usuario);
Form_Usuario.ShowModal;
Form_Usuario.Free;
end;

procedure TForm_menu.Estado1Click(Sender: TObject);
begin
Application.CreateForm(TForm_EStado,Form_EStado);
Form_EStado.ShowModal;
Form_EStado.Free;
end;

procedure TForm_menu.Produto1Click(Sender: TObject);
begin
Application.CreateForm(TForm_Marca,Form_Marca);
Form_Marca.ShowModal;
Form_Marca.Free;


end;

procedure TForm_menu.Usario1Click(Sender: TObject);
begin
Application.CreateForm(TForm_Produto,Form_Produto);
Form_Produto.ShowModal;
DM.Q_Grupo.Open;

end;

procedure TForm_menu.ContasaPagarClick(Sender: TObject);
begin
Application.CreateForm(TRel_Tela_Contas_Pagar,Rel_Tela_Contas_Pagar);
Rel_Tela_Contas_Pagar.ShowModal;
Rel_Tela_Contas_Pagar.Free;
end;

procedure TForm_menu.Produto2Click(Sender: TObject);
begin
Application.CreateForm(TRel_Produto,Rel_Produto);
Rel_Produto.Relatorio.Preview;
Rel_Produto.Free;
end;

procedure TForm_menu.rocarUsario1Click(Sender: TObject);
begin
//Form_LOGIN.BtnCancelar.Enabled := False;
Application.CreateForm(TForm_login,Form_login);
Form_login.ShowModal;
Form_login.Free;

end;

procedure TForm_menu.SobreoSistema1Click(Sender: TObject);
begin
Application.CreateForm(TSobre_Sistema,Sobre_Sistema);
Sobre_Sistema.ShowModal;
Sobre_Sistema.Free;
end;

procedure TForm_menu.SairdoSistema1Click(Sender: TObject);
begin
if Application.MessageBox('Deseja Sair do Sistema ?','SOF CONTROL', MB_yesno + MB_Iconquestion) = Id_YES then begin

  Application.Terminate;
end;
end;

procedure TForm_menu.CAixa2Click(Sender: TObject);
begin
Application.CreateForm(TRel_Tela_Caixa,Rel_Tela_Caixa);
Rel_Tela_Caixa.ShowModal;
Rel_Tela_Caixa.Free;
end;

procedure TForm_menu.Cidade1Click(Sender: TObject);
begin
Application.CreateForm(TRel_Cidade,Rel_Cidade);
Rel_Cidade.Relatorio.Preview;
Rel_Cidade.Free;
end;

procedure TForm_menu.Descarte1Click(Sender: TObject);
begin
Application.CreateForm(TForm_Descarte,Form_Descarte);
Form_Descarte.ShowModal;
Form_Descarte.Free;

end;

procedure TForm_menu.ContasaReceber3Click(Sender: TObject);
begin
Application.CreateForm(TRel_Tela_Contas_Receber,Rel_Tela_Contas_Receber);
Rel_Tela_Contas_Receber.ShowModal;
Rel_Tela_Contas_Receber.Free;
end;

procedure TForm_menu.Button10Click(Sender: TObject);
var o : integer;
  I: Integer;
  fAlertaMsn: TForm;
  BarraIniciar: HWND; {Barra Iniciar}
  tmAltura: Integer;
  tmRect: TRect;
  xTop : Integer;
  xIniTop : Integer;
begin
Button1.Visible := False;
DateEdit1.Date := (Now);
DateEdit1.Visible := False;
o := 0;
if DateEdit1.Date = (date)then begin
  dm.Q_Caixa.First;
  while NOT dm.Q_caixa.Eof do begin
    if dm.Q_CaixaDT_INICIAL.Value = (date) then begin
      o := 1;
    end;

    dm.Q_caixa.Next;
end;
end;
 if o = 0 then begin
   //localiza o Handle da janela iniciar
  BarraIniciar := FindWindow('Shell_TrayWnd', nil);
  //Pega o "retângulo" que envolve a barra e sua altura
  GetWindowRect(BarraIniciar, tmRect);
  tmAltura := tmRect.Bottom - tmRect.Top;
  fAlertaMsn := TFormAlerta.Create(Self);
  with fAlertaMsn do
  begin
    Left := Screen.Width - ClientWidth;
    if tmRect.Top = -2 then
      tmAltura := 30;
    //Pega o top final
    xTop := Screen.Height - ClientHeight - tmAltura;
    //Pega o top inicial
    xIniTop := Screen.Height + ClientHeight + tmAltura;
    Top := xIniTop;
    for I := xIniTop downto xTop do
    begin
      Top := Top - 1;
      Show;
      Update;
      Application.ProcessMessages;
      Sleep(1);
    end;
    Sleep(10000);
    Close;
    FreeAndNil(fAlertaMsn);

end;
end;

end;

procedure TForm_menu.Button1Click(Sender: TObject);
var o : integer;
  I: Integer;
  fAlertaMsn: TForm;
  BarraIniciar: HWND; {Barra Iniciar}
  tmAltura: Integer;
  tmRect: TRect;
  xTop : Integer;
  xIniTop : Integer;
begin
//Button1.Visible := False;
DateEdit1.Date := (Now);
DateEdit1.Visible := False;
o := 0;
if DateEdit1.Date = (date)then begin
  dm.Q_Caixa.First;
  while NOT dm.Q_caixa.Eof do begin
    if dm.Q_CaixaDT_INICIAL.Value = (date) then begin
      o := 1;
    end;

    dm.Q_caixa.Next;
end;
end;
 if o = 0 then begin
   //localiza o Handle da janela iniciar
  BarraIniciar := FindWindow('Shell_TrayWnd', nil);
  //Pega o "retângulo" que envolve a barra e sua altura
  GetWindowRect(BarraIniciar, tmRect);
  tmAltura := tmRect.Bottom - tmRect.Top;
  fAlertaMsn := TFormAlerta.Create(Self);
  with fAlertaMsn do
  begin
    Left := Screen.Width - ClientWidth;
    if tmRect.Top = -2 then
      tmAltura := 30;
    //Pega o top final
    xTop := Screen.Height - ClientHeight - tmAltura;
    //Pega o top inicial
    xIniTop := Screen.Height + ClientHeight + tmAltura;
    Top := xIniTop;
    for I := xIniTop downto xTop do
    begin
      Top := Top - 1;
      Show;
      Update;
      Application.ProcessMessages;
      //Sleep(1);
    end;
    Sleep(10000);
    Close;
    FreeAndNil(fAlertaMsn);

end;
end;


end;

procedure TForm_menu.Calculadora1Click(Sender: TObject);
begin
WinExec('calc.exe', sw_show);
end;

procedure TForm_menu.Restaurar1Click(Sender: TObject);
begin
bck := 1;
Application.CreateForm(TForm_backup,Form_backup );
Form_backup.ShowModal;
Form_backup.Free;
end;

procedure TForm_menu.Realizar1Click(Sender: TObject);
begin
bck := 2;
Application.CreateForm(TForm_backup,Form_backup );
Form_backup.ShowModal;
Form_backup.Free;
end;

procedure TForm_menu.BitBtn1Click(Sender: TObject);
begin
//HlinkNavigateString(nil,'file:C:\xampp\htdocs\Site_Trabalho\index.html');
//WebBrowser1.Navigate('file:C:\xampp\htdocs\Site_Trabalho\index.html') ;

Application.CreateForm(TForm1,Form1);
Form1.ShowModal;
Form1.Free;
end;

procedure TForm_menu.ContasaPagar2Click(Sender: TObject);
begin
Application.CreateForm(TRel_Tela_Compra,Rel_Tela_Compra);
Rel_Tela_Compra.ShowModal;
Rel_Tela_Compra.Free;
end;

procedure TForm_menu.Venda1Click(Sender: TObject);
begin
 Application.CreateForm(TRel_Tela_Venda,Rel_Tela_Venda);
Rel_Tela_Venda.ShowModal;
Rel_Tela_Venda.Free
end;

procedure TForm_menu.DoSistema1Click(Sender: TObject);
begin
Application.CreateForm(TForm1,Form1);
Form1.ShowModal;
Form1.Free;
end;

end.
